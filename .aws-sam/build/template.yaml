AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Globals:
  Function:
    Timeout: 5
    Handler: handler
    Runtime: go1.x
    Architectures:
    - x86_64
    Tracing: Active
Resources:
  UserManagement:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: UserManagement
      Policies:
        DynamoDBCrudPolicy:
          TableName: Fitbit
      Events:
        SignUp:
          Type: Api
          Properties:
            Path: /signup
            Method: Post
        RenderSignup:
          Type: Api
          Properties:
            Path: /signup
            Method: Get
        RenderLogin:
          Type: Api
          Properties:
            Path: /login
            Method: Get
        Login:
          Type: Api
          Properties:
            Path: /login
            Method: Post
  ProfileManagement:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: ProfileManagement
      Policies:
        DynamoDBCrudPolicy:
          TableName: Fitbit
      Events:
        ReadProfile:
          Type: Api
          Properties:
            Path: /profile/{username}
            Method: Get
        UpdateProfile:
          Type: Api
          Properties:
            Path: /profile/{username}
            Method: Post
  TermsOfService:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: TermsOfService
      Events:
        CatchAll:
          Type: Api
          Properties:
            Path: /terms
            Method: GET
  LandingPage:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: LandingPage
      Events:
        CatchAll:
          Type: Api
          Properties:
            Path: /
            Method: GET
  Oauth:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: Oauth
      Events:
        GetCode:
          Type: Api
          Properties:
            Path: /auth_code
            Method: GET
        Token:
          Type: Api
          Properties:
            Path: /webhook
            Method: GET
  PrivacyPolicy:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: PrivacyPolicy
      Events:
        CatchAll:
          Type: Api
          Properties:
            Path: /privacy
            Method: GET
  WebhookData:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: WebhookData
      Events:
        CatchAll:
          Type: Api
          Properties:
            Path: /webhook_data
            Method: POST
